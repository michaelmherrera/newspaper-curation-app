<!DOCTYPE html>
<html lang="en-us">
<head><script src="/newspaper-curation-app/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=newspaper-curation-app/livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>SFTPGo Integration - Newspaper Curation App</title>
<meta name="description" content="Setting up NCA for SFTPGo integration">
<meta name="generator" content="Hugo 0.83.1" />
<link href="http://localhost:1313/newspaper-curation-app//index.xml" rel="alternate" type="application/rss+xml">
<link rel="canonical" href="http://localhost:1313/newspaper-curation-app/setup/sftpgo-integration/">
<link rel="stylesheet" href="http://localhost:1313/newspaper-curation-app/css/theme.min.css">
<script src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
<link rel="stylesheet" href="http://localhost:1313/newspaper-curation-app/css/chroma.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script>
<script src="http://localhost:1313/newspaper-curation-app/js/bundle.js"></script><style>
:root {}
</style>
<meta property="og:title" content="SFTPGo Integration" />
<meta property="og:description" content="Setting up NCA for SFTPGo integration" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/newspaper-curation-app/setup/sftpgo-integration/" /><meta property="article:section" content="setup" />



<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SFTPGo Integration"/>
<meta name="twitter:description" content="Setting up NCA for SFTPGo integration"/>
<meta itemprop="name" content="SFTPGo Integration">
<meta itemprop="description" content="Setting up NCA for SFTPGo integration">

<meta itemprop="wordCount" content="438">
<meta itemprop="keywords" content="" /></head>
<body>

<div class="container"><header>
<h1>Newspaper Curation App</h1><a href="https://github.com/uoregon-libraries/newspaper-curation-app/" class="github"><i class="fab fa-github"></i></a>
</header>

<div class="content-container">
<main><h1>SFTPGo Integration</h1>
<p><a href="https://github.com/drakkan/sftpgo">SFTPGo</a> is an sftp server that exposes APIs
and a web interface for administration tasks.  We&rsquo;ve chosen to integrate NCA
with SFTPGo in order to simplify the process of creating a new publisher.  If
you choose not to use it, publisher uploads will have to be managed entirely by
you (as was the case prior to this integration), and NCA will not track SFTP
data (which is a change from NCA 3.x and prior).</p>
<h2 id="opt-out">Opt out</h2>
<p>To disable SFTPGo integration, assign &ldquo;-&rdquo; to the <code>SFTPGO_API_URL</code> setting:</p>
<pre><code>SFTPGO_API_URL=&quot;-&quot;
</code></pre>
<p>This ensures that NCA will not try to connect to a nonexistent server.</p>
<h2 id="setup">Setup</h2>
<p>If you use SFTPGo, you&rsquo;ll need to use the SFTPGo documentation to set it up
however it makes sense for your system, and then make NCA aware of it.</p>
<p>First, set the URL appropriately to the API endpoint.  For our docker setup, we
expose SFTPGo internally docker-compose services at the URL
<code>http://sftpgo:8080</code>.  The API is just that host combined with the path
<code>/api/v2</code>, leaving us with this:</p>
<pre><code>SFTPGO_API_URL=&quot;http://sftpgo:8080/api/v2&quot;
</code></pre>
<p>Next, create an admin user in SFTPGo and then decomission the default admin
(&ldquo;admin&rdquo;), or at least alter the default user&rsquo;s password to be significantly
more secure than simply &ldquo;password&rdquo;, and then update the credentials in NCA&rsquo;s
settings file.</p>
<p>Finally, choose a default quota for new users.  This ensures one publisher
can&rsquo;t blast hundreds of gigs (or even terabytes) of data, preventing all other
publishers from uploading anything.</p>
<h2 id="usage">Usage</h2>
<p>Once SFTPGo is integrated, any titles created in NCA will be sent to SFTPGo.
If you had been doing sftp the traditional way (local accounts using ssh with
the login shell disabled), you will find that a big advantage to SFTPGo is that
it doesn&rsquo;t need a local system administrator to manage users, quotas, etc.
Provisioning accounts will be automated from NCA, and management can be done
using the SFTPGo web API or the REST endpoints.</p>
<h2 id="bulk-loading">Bulk loading</h2>
<p>If you were already managing SFTP uploads and you don&rsquo;t want to redo all that
work, NCA can help!  On startup, NCA will scan the <code>titles</code> database table.
Any title that (a) is not SFTPGo-connected, and (b) has values for both the
<code>sftp_user</code> and <code>sftp_pass</code> fields will get sent to SFTPGo in the background.
These SFTP accounts will get the default quota applied, which can then be
edited on an individual basis from NCA.</p>
<p><strong>Note</strong>: for security reasons, titles' passwords will be removed upon
successful integration with SFTPGo.  <em>(Storing plaintext passwords was supposed
to stop happening a long time ago)</em></p>
<p><strong>Advanced users</strong> can even populate the NCA <code>titles</code> table manually in order
to bulk-load SFTP users which weren&rsquo;t being managed by NCA.</p>
<div class="edit-meta">

<br></div><nav class="pagination"><a class="nav nav-prev" href="http://localhost:1313/newspaper-curation-app/setup/creating-publishers/" title="Onboarding A Publisher"><i class="fas fa-arrow-left" aria-hidden="true"></i>&nbsp;Prev - Onboarding A Publisher</a>
<a class="nav nav-next" href="http://localhost:1313/newspaper-curation-app/specs/" title="NCA Terms, Specs, and Information">Next - NCA Terms, Specs, and Information <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav><footer><p class="powered">Powered by <a href="https://gohugo.io">Hugo</a>. Theme by <a href="https://themes.gohugo.io/hugo-theme-techdoc/">TechDoc</a>. Designed by <a href="https://github.com/thingsym/hugo-theme-techdoc">Thingsym</a>.</p>
</footer>
</main>
<div class="sidebar">

<nav class="open-menu">
<ul>
<li class=""><a href="http://localhost:1313/newspaper-curation-app/">Home</a></li>

<li class="parent"><a href="http://localhost:1313/newspaper-curation-app/setup/">Setup and Installation</a>
  
<ul class="sub-menu">
<li class=""><a href="http://localhost:1313/newspaper-curation-app/setup/services/">Services and Apps</a></li>
<li class=""><a href="http://localhost:1313/newspaper-curation-app/setup/server-setup/">Server Setup</a></li>
<li class=""><a href="http://localhost:1313/newspaper-curation-app/setup/installation/">Installation</a></li>
<li class=""><a href="http://localhost:1313/newspaper-curation-app/setup/user-setup/">Users</a></li>
<li class=""><a href="http://localhost:1313/newspaper-curation-app/setup/creating-publishers/">Onboarding A Publisher</a></li>
<li class="active"><a href="http://localhost:1313/newspaper-curation-app/setup/sftpgo-integration/">SFTPGo Integration</a></li>
</ul>
  
</li>

<li class=""><a href="http://localhost:1313/newspaper-curation-app/specs/">NCA Terms, Specs, and Information</a>
  
<ul class="sub-menu">
<li class=""><a href="http://localhost:1313/newspaper-curation-app/specs/glossary/">Glossary</a></li>
<li class=""><a href="http://localhost:1313/newspaper-curation-app/specs/upload-specs/">Uploads: Folder and File Specs</a></li>
</ul>
  
</li>

<li class=""><a href="http://localhost:1313/newspaper-curation-app/workflow/">Workflow</a>
  
<ul class="sub-menu">
<li class=""><a href="http://localhost:1313/newspaper-curation-app/workflow/technical/">Technical Details</a></li>
<li class=""><a href="http://localhost:1313/newspaper-curation-app/workflow/adding-titles/">Adding Titles</a></li>
<li class=""><a href="http://localhost:1313/newspaper-curation-app/workflow/handling-page-review-problems/">Handling Page Review Problems</a></li>
<li class=""><a href="http://localhost:1313/newspaper-curation-app/workflow/fixing-flagged-workflow-issues/">Fixing Flagged Workflow Issues</a></li>
<li class=""><a href="http://localhost:1313/newspaper-curation-app/workflow/bulk-load-sftpgo/">Bulk-load SFTPGo Users</a></li>
<li class=""><a href="http://localhost:1313/newspaper-curation-app/workflow/fixing-batches/">Fixing Batches</a></li>
<li class=""><a href="http://localhost:1313/newspaper-curation-app/workflow/batch-manual-golive/">Batch Manual Go-live Procedure</a></li>
</ul>
  
</li>

<li class=""><a href="http://localhost:1313/newspaper-curation-app/contributing/">Contributing</a>
  
<ul class="sub-menu">
<li class=""><a href="http://localhost:1313/newspaper-curation-app/contributing/dev-guide/">Developer&#39;s Guide</a></li>
<li class=""><a href="http://localhost:1313/newspaper-curation-app/contributing/not-compiling-locally/">Not Compiling Locally</a></li>
<li class=""><a href="http://localhost:1313/newspaper-curation-app/contributing/documentation/">Contributing to Documentation</a></li>
<li class=""><a href="http://localhost:1313/newspaper-curation-app/contributing/testing/">Testing</a></li>

<li class=""><a href="http://localhost:1313/newspaper-curation-app/contributing/dev-howto/">How do I...?</a>
  
<ul class="sub-menu">
<li class=""><a href="http://localhost:1313/newspaper-curation-app/contributing/dev-howto/add-job-types/">Add Job Types</a></li>
</ul>
  
</li>
</ul>
  
</li>
</ul>
</nav>



<div class="sidebar-footer"></div>
</div>

</div><a href="#" id="backtothetop-fixed" class="backtothetop"
 data-backtothetop-duration="600"
 data-backtothetop-easing="easeOutQuart"
 data-backtothetop-fixed-fadeIn="1000"
 data-backtothetop-fixed-fadeOut="1000"
 data-backtothetop-fixed-bottom="10"
 data-backtothetop-fixed-right="20">
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div>
</body>
</html>
