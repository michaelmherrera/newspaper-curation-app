{{block "content" .}}

{{if gt (len .Data.Issue.Errors) 0}}
  This issue had the following errors:
  <ul>
  {{range .Data.Issue.Errors}}
    <li>{{.}}</li>
  {{end}}
  </ul>
{{else}}
  <form action="{{.Data.Issue.WorkflowPath "queue"}}" method="POST">
    <p>No critical errors detected</p>
    {{if .Data.Issue.QueueInfo}}
      <div class="alert alert-warning">{{.Data.Issue.QueueInfo}}</div>
    {{end}}
    {{if .Data.Issue.IsDangerouslyNew}}
        <div class="alert alert-warning">This issue is very new and may get more uploads, so queueing is not permitted</div>
    {{else}}
      {{if .Data.Issue.IsNew}}
        <div class="alert alert-warning">This issue is relatively new and may get more uploads - queue with care!</div>
      {{end}}

      {{if .User.PermittedTo ModifyUploadedIssues}}
        <div><button type="submit">Queue Issue</button> for derivative generation</div>
      {{end}}
    {{end}}
  </form>
{{end}}

<hr />

<table class="table table-striped table-bordered table-condensed sortable">
  <thead>
    <tr>
      <th scope="col" class="sort-alpha">Filename</th>
      <th scope="col" class="sort-alpha">Last Modified</th>
      <th scope="col" class="sort-alpha">Status</th>
    </tr>
  </thead>

  <tbody>
    {{range .Data.Issue.Files}}
      <tr {{if gt (len .Errors) 0}} class="file-with-errors"{{end}}>
        <td>{{.Link}}</td>
        <td>{{TimeString .ModTime}}</td>
        <td>
          {{- if gt (len .Errors) 0}}
            <b>{{.Errors}}</b>
          {{- else}}
            No file errors detected
          {{- end}}
        </td>
      </tr>
    {{end}}
  </tbody>
</table>

<script>SortableTable.initAll()</script>
{{end}}
